# **NOTE**: this file is generated by `dhall-render`.
# You should NOT edit it manually, your changes will be lost.

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  annotations:
    sidecar.istio.io/inject: 'true'
  labels:
    app.kubernetes.io/name: classic-mail-ticket-creator
    app.kubernetes.io/version: zenspider-70-999-d85f0ce4
    datadog_log_index: support-mail-processing
    product: support
    project: classic
    role: mail-ticket-creator
    sidecar.istio.io/inject: 'true'
    team: email-engineering
  name: classic-mail-ticket-creator
  namespace: classic
spec:
  replicas: 3
  selector:
    matchLabels:
      project: classic
      role: mail-ticket-creator
  serviceName: mail-ticket-creator
  template:
    metadata:
      annotations:
        proxy.istio.io/config: |-
          terminationDrainDuration: 50s
          concurrency: 2
        sidecar.istio.io/inject: 'true'
        sidecar.istio.io/logLevel: warning
        sidecar.istio.io/proxyCPU: 300m
        sidecar.istio.io/proxyCPULimit: '4'
        sidecar.istio.io/proxyMemory: 480Mi
        sidecar.istio.io/proxyMemoryLimit: 2Gi
        traffic.sidecar.istio.io/excludeOutboundIPRanges: 172.29.9.251/32
        traffic.sidecar.istio.io/includeOutboundIPRanges: 10.0.0.0/8,172.16.0.0/12,240.240.0.0/16
      labels:
        app.kubernetes.io/name: classic-mail-ticket-creator
        app.kubernetes.io/version: zenspider-70-999-d85f0ce4
        datadog_log_index: support-mail-processing
        product: support
        project: classic
        role: mail-ticket-creator
        secret-service.zende.sk/sidecar: sidecar
        sidecar.istio.io/inject: 'true'
        team: email-engineering
        temp-auth: disabled
      name: classic-mail-ticket-creator
    spec:
      containers:
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-0
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-0
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-1
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-1
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-2
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-2
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-3
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-3
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-4
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-4
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-5
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-5
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-6
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-6
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-7
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-7
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-8
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-8
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-9
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-9
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-10
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-10
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - args:
        - script/mail_ticket_creator.rb
        command:
        - script/docker-boot
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              fieldPath: status.podIP
        - name: REVISION
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: TAG
          value: d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        - name: DEPLOY_GROUP
          value: staging998
        - name: PROJECT
          value: classic
        - name: ROLE
          value: mail-ticket-creator
        - name: VERSION
          valueFrom:
            fieldRef:
              fieldPath: metadata.labels['app.kubernetes.io/version']
        - name: BUNDLE_GEMFILE
          value: Gemfile.next
        - name: DISABLE_PERMISSIONS_AGENT_FOR_TICKET_ACCESS
          value: 'false'
        - name: MYSQL_READ_TIMEOUT
          value: '15'
        - name: CLASSIC_CONTAINER_NAME
          value: classic-mail-ticket-creator-11
        - name: VECTOR_LOGGING_DEFAULT_ATTRIBUTES
          value: '{"application":"mail_ticket_creator","service":"mail-ticket-creator"
            }'
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '35'
        livenessProbe:
          exec:
            command:
            - script/kubernetes_mtc_liveness
          failureThreshold: 6
          initialDelaySeconds: 15
          periodSeconds: 600
          successThreshold: 1
          timeoutSeconds: 10
        name: classic-mail-ticket-creator-11
        resources:
          limits:
            cpu: 835m
            memory: 6Gi
          requests:
            cpu: 300m
            memory: 5Gi
        startupProbe:
          exec:
            command:
            - script/kubernetes_mtc_startup
          failureThreshold: 20
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 10
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
        - mountPath: "/data/zendesk"
          name: maildir
      - command:
        - wait_for_envoy
        - "/bin/uhaul"
        env:
        - name: CLEAN_DIRS
          value: "/data/zendesk/json_mail/failed,/data/zendesk/json_mail/done"
        - name: RCVR_PATH
          value: "/data/zendesk/json_mail/new"
        - name: DD_ASSOCIATED_SERVICE_SUB_PATH
          value: mtc
        - name: CLEAN_DONE_AGE_MINS
          value: '30'
        - name: CLEAN_INTERVAL_MINS
          value: '15'
        - name: SENTRY_PROJECT
          value: uhaul
        - name: RCVR_FILE_TYPES
          value: application/json
        - name: ISTIO_STATUS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.annotations['sidecar.istio.io/status']
        envFrom:
        - configMapRef:
            name: classic-env-d85f0ce4f0185f4971afecf68dc7318f4ea128ca
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/prod/zendesk/uhaul:c213b758e952f5e7a5c2f5a0fc119bb9a4752e10
        lifecycle:
          preStop:
            exec:
              command:
              - sleep
              - '31'
        livenessProbe:
          failureThreshold: 18
          httpGet:
            path: "/z/ping"
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 2
        name: uhaul
        ports:
        - containerPort: 8080
          name: main-port
          protocol: TCP
        resources:
          limits:
            cpu: '0.5'
            memory: 10Gi
          requests:
            cpu: '0.1'
            memory: 8Gi
        startupProbe:
          failureThreshold: 18
          httpGet:
            path: "/z/ping"
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 2
        volumeMounts:
        - mountPath: "/data/zendesk"
          name: maildir
      dnsConfig:
        options:
        - name: single-request-reopen
      initContainers:
      - command:
        - script/classic-init-container.sh
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/dev/zendesk/zendesk/app@sha256:11b691cdc24ac51cf2036140f9b69e3e8c3ee59d19114e7805142de5d8c28ab4
        name: classic-init
        resources:
          limits:
            cpu: 100m
            memory: 50Mi
          requests:
            cpu: 100m
            memory: 50Mi
        securityContext:
          capabilities:
            add:
            - NET_ADMIN
          runAsGroup: 0
          runAsUser: 0
        volumeMounts:
        - mountPath: "/app/config/networks.d"
          name: network-config
        - mountPath: "/app/config/radar.d"
          name: radar
        - mountPath: "/app/config/attachments.d"
          name: attachments
        - mountPath: "/tmp"
          name: tmp
      - command:
        - "/bin/sh"
        - "-c"
        - |
          mkdir -p /data/zendesk/json_mail/backlog/cur;
          mkdir -p /data/zendesk/json_mail/done/cur;
          mkdir -p /data/zendesk/json_mail/failed/cur;
          mkdir -p /data/zendesk/json_mail/new/cur;
          mkdir -p /data/zendesk/json_mail/new_uhaul/cur;
          mkdir -p /data/zendesk/json_mail/retry/cur;
          mkdir -p /data/zendesk/json_mail/tmp;
        image: 713408432298.dkr.ecr.us-west-2.amazonaws.com/base/zendesk/docker-images-base/ubuntu:22.04
        name: mail-directories-init
        resources:
          limits:
            cpu: 100m
            memory: 50Mi
          requests:
            cpu: 100m
            memory: 50Mi
        securityContext:
          runAsUser: 1000
        volumeMounts:
        - mountPath: "/data/zendesk"
          name: maildir
      nodeSelector:
        node.kubernetes.io/role: s3nat-node
      securityContext:
        fsGroup: 1000
      terminationGracePeriodSeconds: 45
      tolerations:
      - effect: NoSchedule
        key: compute.zende.sk/nodegroup
        value: s3nat
      volumes:
      - configMap:
          name: networks
        name: network-config
      - configMap:
          name: radar
        name: radar
      - configMap:
          name: attachments
        name: attachments
      - emptyDir: {}
        name: tmp
  volumeClaimTemplates:
  - apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      labels:
        product: support
        project: classic
        role: mail-ticket-creator
        team: email-engineering
      name: maildir
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 50Gi
      storageClassName: ebs-csi-gp2
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/name: classic-mail-ticket-creator
    app.kubernetes.io/version: zenspider-70-999-d85f0ce4
    kube-service-watcher/namespace_suffix: 'false'
    product: support
    project: classic
    role: mail-ticket-creator
    team: email-engineering
  name: mail-uhaul
  namespace: classic
spec:
  ports:
  - name: http-mail-uhaul
    port: 4285
    targetPort: main-port
  selector:
    project: classic
    role: mail-ticket-creator
  type: ClusterIP
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  annotations:
    strategy.spinnaker.io/replace: 'true'
  labels:
    product: support
    project: classic
    role: mail-ticket-creator
    team: email-engineering
  name: classic-mail-ticket-creator
  namespace: classic
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      project: classic
      role: mail-ticket-creator
